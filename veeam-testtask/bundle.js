!function(e){var t={};function n(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(s,r,function(t){return e[t]}.bind(null,r));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8)}([function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);const s="GET",r={AFTER_BEGIN:"afterbegin",BEFORE_END:"beforeend"},i="friends",a="posts",o=e=>{if(e.status>=200&&e.status<300)return e;throw new Error(`${e.status}: ${e.statusText}`)};const l=(e,t)=>{e.querySelector("."+t).classList.remove(t)},c=e=>Math.round(e.length/3),u=(e,t,n)=>e.slice(t,n),d=(e,t,n)=>{switch(n){case r.AFTER_BEGIN:e.prepend(t);break;case r.BEFORE_END:e.append(t)}},h=e=>{e.getElement().remove(),e.removeElement()};class _{constructor(){if(new.target===_)throw new Error("Can't instantiate AbstractComponent, only concrete one.");this._element=null}getTemplate(){throw new Error("Abstract method not implemented: getTemplate")}getElement(){return this._element||(this._element=(e=>{const t=document.createElement("div");return t.innerHTML=e,t.firstElementChild})(this.getTemplate())),this._element}removeElement(){this._element=null}show(){this._element&&this._element.classList.remove("visually-hidden")}hide(){this._element&&this._element.classList.add("visually-hidden")}}n(0);class p extends _{constructor(e){super(),this._data=e,this._subscribeOnEvents()}getTemplate(){return`<section class="sidebar">\n            <img src="${this._data.medium}" alt="" class="sidebar__photo">\n            <form class="user-photo-form">\n                <label for="user-photo" class="user-photo-form__label">\n                    Change photo\n                </label>\n                <input type="file" id="user-photo" class="visually-hidden" accept="image/*" />\n            </form>\n            <ul class="sidebar-menu">\n                <li class="sidebar-menu__item"><a href="#">My account</a></li>\n                <li class="sidebar-menu__item"><a href="#">Messages</a></li>\n                <li class="sidebar-menu__item"><a href="#">News</a></li>\n                <li class="sidebar-menu__item"><a href="#">Photos</a></li>\n                <li class="sidebar-menu__item"><a href="#">Video</a></li>\n                <li class="sidebar-menu__item"><a href="#">Bookmarks</a></li>\n            </ul>\n        </section>`}_subscribeOnEvents(){const e=this.getElement().querySelector("#user-photo"),t=this.getElement().querySelector(".sidebar__photo");e.addEventListener("change",e=>{const n=e.target.files;if(FileReader&&n&&n.length){const e=new FileReader;e.onload=function(){t.src=e.result},e.readAsDataURL(n[0])}})}}n(1);class m extends _{constructor(e){super(),this._data=e}getTemplate(){return(e=>{const{name:{first:t,second:n,last:s,title:r},email:i,phone:a,location:{street:{number:o,name:l},city:c,country:u,postcode:d}}=e;return`<section class="about-user">\n            <div class="user-info-area">\n                <p class="user-info-area__name">${t} ${n||""} ${s}</p>\n                <p class="user-info-area__email">email: <span>${i}</span></p>\n                <p class="user-info-area__phone">phone: <span>${a}</span></p>\n                <p>${`${r} ${s}, ${o} ${l}, ${c}, ${u}, ${d}`}</p>\n            </div>\n            <ul class="activity-area">\n                <li class="activity-area__item">\n                    <a href="#">\n                        <span>11</span>\n                        new messages\n                       </a>\n                </li>\n                <li class="activity-area__item">\n                    <a href="#">\n                        <span>0</span>    \n                        new requests\n                    </a>\n                </li>\n                <li class="activity-area__item">\n                    <a href="#">\n                        <span>7</span>\n                        new photos        \n                    </a>\n                </li>\n            </ul>\n        </section>`})(this._data)}}class f{constructor(){this._friends=[]}getFriends(){return this._friends}setFriends(e){this._friends=Array.from(e)}filterFriendsByQuery(e){return e?this.getFriends().slice().filter(t=>{const{email:n,first_name:s,last_name:r}=t;return[n,s,r].some(t=>-1!==t.indexOf(e))}):this.getFriends()}}class g extends _{recoveryListeners(){throw new Error("Abstract method not implemented: recoveryListeners")}rerender(){const e=this.getElement(),t=e.parentElement;this.removeElement();const n=this.getElement();t.replaceChild(n,e),this.recoveryListeners()}}n(2);const E=e=>`<section class="friends-list-wrapper">\n            <ul class="friends-list">\n                ${e.map(e=>(e=>{const{avatar:t,first_name:n,last_name:s,email:r}=e;return`<li class="friends-list__item">\n            <img src='${t}' alt='${name} ${s}' />\n            <p>${n}</p>\n            <p>${s}</p>\n            <p>email: <span>${r}</span></p>\n        </li>`})(e)).join("")}\n            </ul>\n        </section>`;class b extends g{constructor(e){super(),this._friendsList=e}getTemplate(){return E(this._friendsList)}rerender(e){this._friendsList=e,super.rerender()}recoveryListeners(){}}n(3);class v extends _{constructor(e){super(),this._pageCount=e}getTemplate(){return(e=>{const t=[];for(let n=1;n<=e;n++)t.push(`\n            <button\n                type="button"\n                data-count="${n}"\n                class="pagination__button ${1===n?"pagination__button--active":""}"\n            >\n                ${n}\n            </button>\n        `);return`<div class="pagination">\n           ${t.join("")}\n        </div>`})(this._pageCount)}setPaginationButtonClickHandler(e){this.getElement().addEventListener("click",e)}}class y{constructor(e){this._friendsList=e.getFriends(),this._pagesCount=c(this._friendsList),this._currentSliceCountPosition=0;const t=this._getStopSlicePoint(),n=u(this._friendsList,this._currentSliceCountPosition,t);this._friends=new b(n),this._pagesCount>1&&(this._pagination=new v(this._pagesCount))}_getStopSlicePoint(e=0){return e+3}render(e){d(e,this._friends.getElement(),r.BEFORE_END),this._pagination&&(d(e,this._pagination.getElement(),r.BEFORE_END),this.setPaginationListener())}remove(){h(this._friends),this._friends.removeElement(),h(this._pagination),this._pagination.removeElement()}getFilteredFriends(e){this._currentSliceCountPosition=0;const t=this._getStopSlicePoint(),n=u(e,this._currentSliceCountPosition,t);if(this._pagesCount=c(e),this._friends.rerender(n),this._pagesCount>1)return this._pagination.show(),!1;this._pagination.hide()}setPaginationListener(){this._pagination.setPaginationButtonClickHandler(e=>{e.preventDefault();const t=this._pagination.getElement();l(t,"pagination__button--active"),e.target.classList.add("pagination__button--active");const n=parseInt(e.target.dataset.count),s=n-1;this._currentSliceCountPosition=1===n?0:this._currentSliceCountPosition+3*s;const r=this._getStopSlicePoint(this._currentSliceCountPosition),i=u(this._friendsList,this._currentSliceCountPosition,r);this._friends.rerender(i)})}}n(4);class F extends _{constructor(e){super(),this._data=e.value}getTemplate(){return`<ul class="posts-list">\n            ${this._data.map(e=>(e=>{const{title:t,body:n}=e;return`<li class="posts-list__item">\n            <h3>${t}</h3>\n            <p>${n}</p>\n        </li>`})(e)).join("")}\n        </ul>`}}n(5);class S extends _{getTemplate(){return`<section class="feature-wrapper">\n            <div class="features-tabs">\n                <button class="features-tabs__item features-tabs__item--active" data-type="${i}" type="button">Friends</button>\n                <button class="features-tabs__item" data-type="${a}" type="button">Posts</button>\n            </div>\n\n        </section>`}setTabsButtonClickHandler(e){this.getElement().querySelector(".features-tabs").addEventListener("click",e)}}n(6);class w extends _{getTemplate(){return'<form class="search-form">\n            <label for="search-input" class="visually-hidden">Поиск...</label>\n            <input type="text" id="search-input" name="search-input" placeholder="filter friends">\n        </form>'}setSearchStringChangeHandler(e){this.getElement().querySelector("#search-input").addEventListener("input",e)}setFormSubmitHandler(e){this.getElement().addEventListener("submit",e)}}class P{constructor(e,t){const[n,s]=t,r=n.value.data;this._search=new w,this._friendsModel=new f,this._friendsModel.setFriends(r),this._featuresArea=new S,this._posts=new F(s),this._featureRenderPlace=null,this._dataType=i,this._friendsController=new y(this._friendsModel),this._container=e}render(){d(this._container,this._featuresArea.getElement(),r.BEFORE_END),this._featureRenderPlace=this._container.querySelector(".feature-wrapper"),d(this._featureRenderPlace,this._search.getElement(),r.BEFORE_END),this._friendsController.render(this._featureRenderPlace),this.setTabsListener(),this.setFilterListener()}setTabsListener(){this._featuresArea.setTabsButtonClickHandler(e=>{e.preventDefault();const t=e.target.dataset.type;if(this._dataType===t)return!1;return l(this._container,"features-tabs__item--active"),e.target.classList.add("features-tabs__item--active"),t&&"friends"===t?(d(this._featureRenderPlace,this._search.getElement(),r.BEFORE_END),this._friendsController.render(this._featureRenderPlace),h(this._posts),this._posts.removeElement(),this._dataType=t,!1):!t||"posts"!==t||(d(this._featureRenderPlace,this._posts.getElement(),r.BEFORE_END),h(this._search),this._friendsController.remove(),this._dataType=t,!1)})}setFilterListener(){const e=((e,t)=>{let n=0;return function(...s){const r=(new Date).getTime();if(!(r-n<t))return n=r,e(...s)}})(e=>{e.preventDefault();const t=e.target.value,n=this._friendsModel.filterFriendsByQuery(t);this._friendsController.getFilteredFriends(n)},3e3);this._search.setSearchStringChangeHandler(t=>e(t)),this._search.setFormSubmitHandler(e=>{e.preventDefault();const t=e.target.value,n=this._friendsModel.filterFriendsByQuery(t);this._friendsController.getFilteredFriends(n)})}}n(7);const C=document.querySelector("body").querySelector(".main"),L=C.querySelector(".info-area"),$=new class extends _{getTemplate(){return'\n    <section class="loading">\n        <h2 class="loading__title">Loading...</h2>\n    </section>\n  '}},T=$.getElement();d(L,T,r.BEFORE_END);const R=new class{getUserData(){return this._load({url:"https://randomuser.me/api/"}).then(e=>e.json())}getFriendsList(){return this._load({url:"https://reqres.in/api/users?page=1"}).then(e=>e.json())}getPosts(){return this._load({url:"https://jsonplaceholder.typicode.com/posts"}).then(e=>e.json())}_load({url:e,method:t=s,body:n=null,headers:r=new Headers}){return fetch(""+e,{method:t,body:n,headers:r}).then(o).catch(e=>{throw e})}},B=[R.getFriendsList(),R.getPosts()];R.getUserData().then(e=>{const t=e.results[0],n=new p(t.picture).getElement(),s=new m(t).getElement();d(L,s,r.AFTER_BEGIN),d(C,n,r.AFTER_BEGIN)}).finally(()=>{T.remove(),$.removeElement(),Promise.allSettled(B).then(e=>{new P(L,e).render()})})}]);
//# sourceMappingURL=bundle.js.map